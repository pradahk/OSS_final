🎯 개선된 4단계: KLUE-BERT 키워드 추출 모델 학습 (GPU 최적화)
======================================================================
라벨링된 데이터를 사용하여 단순 키워드 추출 모델 학습
라벨 체계: O (비키워드), B-KEY (키워드 시작), I-KEY (키워드 내부)
======================================================================
🔍 GPU 환경 확인 중...
❌ CUDA 사용 불가능 - CPU 모드로 실행
💡 GPU 사용을 위해서는:
   1. NVIDIA GPU 설치 확인
   2. CUDA 드라이버 설치
   3. PyTorch CUDA 버전 설치: pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
🧹 이전 학습 결과 정리 중...
   🗑️ 파일 삭제: best_model_20250618_160424.pt
   🗑️ 파일 삭제: training_history_20250618_160424.png
   🗑️ 폴더 삭제: klue_keyword_extractor_20250618_160424
✅ 3개 파일/폴더 정리 완료

🕐 학습 세션 ID: 20250618_164856
📂 라벨링된 KLUE 데이터 로드 중...
✅ 발견된 라벨링 파일: 32개
📄 로딩 중: KLUE_tokenized_answers10_labeled.json
   ⚠️ 유효하지 않은 라벨 포함된 샘플 건너뜀
   ✅ 9개 유효 샘플, 34개 키워드
📄 로딩 중: KLUE_tokenized_answers11_labeled.json
   ✅ 10개 유효 샘플, 42개 키워드
📄 로딩 중: KLUE_tokenized_answers12_labeled.json
   ✅ 10개 유효 샘플, 36개 키워드
📄 로딩 중: KLUE_tokenized_answers13_labeled.json
   ✅ 10개 유효 샘플, 34개 키워드
📄 로딩 중: KLUE_tokenized_answers14_labeled.json
   ✅ 10개 유효 샘플, 39개 키워드
📄 로딩 중: KLUE_tokenized_answers15_labeled.json
   ✅ 10개 유효 샘플, 44개 키워드
📄 로딩 중: KLUE_tokenized_answers16_labeled.json
   ✅ 10개 유효 샘플, 55개 키워드
📄 로딩 중: KLUE_tokenized_answers17_labeled.json
   ✅ 10개 유효 샘플, 41개 키워드
📄 로딩 중: KLUE_tokenized_answers18_labeled.json
   ✅ 10개 유효 샘플, 40개 키워드
📄 로딩 중: KLUE_tokenized_answers19_labeled.json
   ✅ 10개 유효 샘플, 46개 키워드
📄 로딩 중: KLUE_tokenized_answers1_labeled.json
   ⚠️ 토큰-라벨 길이 불일치 샘플 건너뜀
   ✅ 9개 유효 샘플, 34개 키워드
📄 로딩 중: KLUE_tokenized_answers20_labeled.json
   ✅ 10개 유효 샘플, 49개 키워드
📄 로딩 중: KLUE_tokenized_answers21_labeled.json
   ✅ 10개 유효 샘플, 40개 키워드
📄 로딩 중: KLUE_tokenized_answers22_labeled.json
   ✅ 10개 유효 샘플, 36개 키워드
📄 로딩 중: KLUE_tokenized_answers23_labeled.json
   ✅ 10개 유효 샘플, 56개 키워드
📄 로딩 중: KLUE_tokenized_answers24_labeled.json
   ✅ 10개 유효 샘플, 57개 키워드
📄 로딩 중: KLUE_tokenized_answers25_labeled.json
   ✅ 10개 유효 샘플, 56개 키워드
📄 로딩 중: KLUE_tokenized_answers26_labeled.json
   ✅ 10개 유효 샘플, 41개 키워드
📄 로딩 중: KLUE_tokenized_answers27_labeled.json
   ✅ 10개 유효 샘플, 51개 키워드
📄 로딩 중: KLUE_tokenized_answers28_labeled.json
   ✅ 10개 유효 샘플, 43개 키워드
📄 로딩 중: KLUE_tokenized_answers29_labeled.json
   ✅ 10개 유효 샘플, 42개 키워드
📄 로딩 중: KLUE_tokenized_answers2_labeled.json
   ✅ 10개 유효 샘플, 52개 키워드
📄 로딩 중: KLUE_tokenized_answers30_labeled.json
   ✅ 10개 유효 샘플, 42개 키워드
📄 로딩 중: KLUE_tokenized_answers31_labeled.json
   ✅ 10개 유효 샘플, 42개 키워드
📄 로딩 중: KLUE_tokenized_answers32_labeled.json
   ✅ 11개 유효 샘플, 53개 키워드
📄 로딩 중: KLUE_tokenized_answers3_labeled.json
   ✅ 10개 유효 샘플, 47개 키워드
📄 로딩 중: KLUE_tokenized_answers4_labeled.json
   ✅ 10개 유효 샘플, 46개 키워드
📄 로딩 중: KLUE_tokenized_answers5_labeled.json
   ✅ 10개 유효 샘플, 45개 키워드
📄 로딩 중: KLUE_tokenized_answers6_labeled.json
   ✅ 10개 유효 샘플, 36개 키워드
📄 로딩 중: KLUE_tokenized_answers7_labeled.json
   ✅ 10개 유효 샘플, 38개 키워드
📄 로딩 중: KLUE_tokenized_answers8_labeled.json
   ✅ 10개 유효 샘플, 40개 키워드
📄 로딩 중: KLUE_tokenized_answers9_labeled.json
   ✅ 10개 유효 샘플, 37개 키워드

📊 라벨링 데이터 로드 완료:
   총 샘플: 319개
   총 키워드: 1,394개
   평균 키워드/샘플: 4.4개

📈 라벨 분포:
   O: 6,050개 (71.5%)
   B-KEY: 1,394개 (16.5%)
   I-KEY: 1,017개 (12.0%)

💡 라벨링 예시:
   원본: 아이들이 아파서 급하게 응급실에 갔을 때 진료 순서를 바꿔준 학생이 있었어요. 그때는 정신...
   🔑 아이 -> B-KEY
   🔑 응급실 -> B-KEY

🔧 KLUE-BERT 토크나이저 로드 중...
C:\Users\admin\anaconda3\envs\oss-final\lib\site-packages\huggingface_hub\file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
✅ KLUE-BERT 토크나이저 로드 완료

📊 데이터셋 분할 및 데이터 로더 생성...
✅ 데이터 분할 완료:
   훈련 데이터: 191개
   검증 데이터: 64개
   테스트 데이터: 64개
   배치 크기: 16
   Pin Memory: False
   Num Workers: 0

📈 훈련 데이터 라벨 분포:
   O: 3,618개 (72.1%)
   B-KEY: 825개 (16.4%)
   I-KEY: 574개 (11.4%)

🏗️ KLUE-BERT 키워드 추출 모델 생성 중...
C:\Users\admin\anaconda3\envs\oss-final\lib\site-packages\huggingface_hub\file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Some weights of the model checkpoint at klue/bert-base were not used when initializing BertModel: ['cls.predictions.transform.LayerNorm.bias', 'cls.seq_relationship.bias', 'cls.seq_relationship.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.bias', 'cls.predictions.transform.LayerNorm.weight']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
✅ KLUE-BERT 키워드 추출 모델 생성 완료 (새로 초기화됨)
   총 파라미터 수: 110,619,651
   학습 가능 파라미터: 110,619,651

🚀 KLUE-BERT 키워드 추출 모델 학습 시작!
   에포크: 7
   학습률: 2e-05
   사용 장치: cpu

📚 에포크 1/7
훈련 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [01:00<00:00,  5.07s/it, Loss=0.8915]
   훈련 손실: 1.0629
   훈련 F1: 0.5191
검증 평가: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:06<00:00,  1.64s/it]
   검증 F1: 0.6813 (정밀도: 0.6525, 재현율: 0.7211)
   🏆 최고 성능 모델 저장 (F1: 0.6813) → best_model_20250618_164856.pt

📚 에포크 2/7
훈련 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [01:00<00:00,  5.05s/it, Loss=0.6324]
   훈련 손실: 0.7176
   훈련 F1: 0.7158
검증 평가: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:06<00:00,  1.64s/it]
   검증 F1: 0.7398 (정밀도: 0.7456, 재현율: 0.7504)
   🏆 최고 성능 모델 저장 (F1: 0.7398) → best_model_20250618_164856.pt

📚 에포크 3/7
훈련 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [01:00<00:00,  5.05s/it, Loss=0.5717]
   훈련 손실: 0.5687
   훈련 F1: 0.7769
검증 평가: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:06<00:00,  1.72s/it]
   검증 F1: 0.7563 (정밀도: 0.7705, 재현율: 0.7657)
   🏆 최고 성능 모델 저장 (F1: 0.7563) → best_model_20250618_164856.pt

📚 에포크 4/7
훈련 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [01:01<00:00,  5.14s/it, Loss=0.4727]
   훈련 손실: 0.4869
   훈련 F1: 0.8124
검증 평가: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:06<00:00,  1.69s/it]
   검증 F1: 0.7701 (정밀도: 0.7793, 재현율: 0.7709)
   🏆 최고 성능 모델 저장 (F1: 0.7701) → best_model_20250618_164856.pt

📚 에포크 5/7
훈련 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [01:01<00:00,  5.11s/it, Loss=0.4614]
   훈련 손실: 0.4402
   훈련 F1: 0.8298
검증 평가: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:06<00:00,  1.68s/it]
   검증 F1: 0.7798 (정밀도: 0.7835, 재현율: 0.7809)
   🏆 최고 성능 모델 저장 (F1: 0.7798) → best_model_20250618_164856.pt

📚 에포크 6/7
훈련 6: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [01:01<00:00,  5.11s/it, Loss=0.3747]
   훈련 손실: 0.4055
   훈련 F1: 0.8425
검증 평가: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:06<00:00,  1.66s/it]
   검증 F1: 0.7773 (정밀도: 0.7863, 재현율: 0.7750)

📚 에포크 7/7
훈련 7: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:59<00:00,  4.93s/it, Loss=0.3623]
   훈련 손실: 0.3930
   훈련 F1: 0.8484
검증 평가: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:06<00:00,  1.64s/it]
   검증 F1: 0.7806 (정밀도: 0.7887, 재현율: 0.7786)
   🏆 최고 성능 모델 저장 (F1: 0.7806) → best_model_20250618_164856.pt

🎉 학습 완료! 최고 검증 F1: 0.7806

📥 최고 성능 모델 로드: best_model_20250618_164856.pt
테스트 평가: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:06<00:00,  1.67s/it]

🔍 최종 테스트 평가 결과:
   정밀도: 0.8039
   재현율: 0.7876
   F1 스코어: 0.7910

📊 상세 분류 리포트:
              precision    recall  f1-score   support

           O       0.89      0.82      0.86      1240
       B-KEY       0.59      0.85      0.70       268
       I-KEY       0.57      0.52      0.54       229

    accuracy                           0.79      1737
   macro avg       0.68      0.73      0.70      1737
weighted avg       0.80      0.79      0.79      1737


💾 모델 저장 중: klue_keyword_extractor_20250618_164856
✅ 모델 저장 완료!
   모델 경로: klue_keyword_extractor_20250618_164856/
   설정 파일: klue_keyword_extractor_20250618_164856/training_config.json

🧪 추론 테스트 (최대 6개 키워드, 디바이스: cpu)
==================================================

테스트 1: 대학에서 처음으로 컴퓨터를 사용해 보았던 기억이 있어요. 신기하고 어색했어요.
키워드 추출 결과:
  🔑 대학 -> B-KEY
  🔑 컴퓨터 -> B-KEY
  🔑 사용 -> B-KEY
  ↳ ##해 -> I-KEY
🎯 추출된 키워드: ['대학', '컴퓨터', '사용해']

테스트 2: 자식들이 대학에 합격한 순간을 잊지 못해요. 서로를 끌어안고 펑펑 울었던 것 같아요.
키워드 추출 결과:
  🔑 자식 -> B-KEY
  ↳ ##들이 -> I-KEY
  🔑 대학 -> B-KEY
  🔑 합격 -> B-KEY
  ↳ ##한 -> I-KEY
  🔑 서로 -> B-KEY
  🔑 끌어안 -> B-KEY
  ↳ ##고 -> I-KEY
  🔑 펑펑 -> B-KEY
🎯 추출된 키워드: ['자식들이', '대학', '합격한', '서로', '끌어안고', '펑펑']

테스트 3: 남편이 연락을 받으면 꼭 청혼해야 겠다는 마음으로 연락했어요. 다행이 청혼에 성공하고 결혼까지 했네요.
키워드 추출 결과:
  🔑 남편 -> B-KEY
  🔑 연락 -> B-KEY
  🔑 청혼 -> B-KEY
  ↳ ##해야 -> I-KEY
  ↳ 겠다는 -> I-KEY
  🔑 연락 -> B-KEY
  ↳ ##했 -> I-KEY
  🔑 청혼 -> B-KEY
  🔑 결혼 -> B-KEY
🎯 추출된 키워드: ['남편', '연락', '청혼해야겠다는', '연락했', '청혼', '결혼']

테스트 4: 삶이 힘들어도 다시 일어설 용기가 필요하다는걸 아이들에게 항상 강조해줬던 것 같아요.
키워드 추출 결과:
  🔑 삶 -> B-KEY
  🔑 힘들 -> B-KEY
  🔑 일어 -> B-KEY
  ↳ ##설 -> I-KEY
  🔑 용기 -> B-KEY
  🔑 아이 -> B-KEY
  ↳ ##들 -> I-KEY
🎯 추출된 키워드: ['삶', '힘들', '일어설', '용기', '아이들']
📊 학습 히스토리 그래프 저장: training_history_20250618_164856.png

🎉 개선된 4단계 완료 보고서 (GPU 최적화)
==================================================
🕐 학습 세션 ID: 20250618_164856
🖥️ 사용 장치: cpu
✅ 훈련 데이터: 319개
✅ 최고 검증 F1: 0.7806
✅ 최종 테스트 F1: 0.7910
✅ 모델 저장: klue_keyword_extractor_20250618_164856/
✅ 최고 모델 파일: best_model_20250618_164856.pt
✅ 학습 곡선: training_history_20250618_164856.png
✅ 라벨 체계: 3개 클래스 (O, B-KEY, I-KEY)

📋 다음 단계:
1. 실제 서비스에 모델 통합
2. 더 많은 라벨링 데이터로 성능 개선
3. 모델 최적화 및 경량화
4. 라벨링 품질 검증 및 개선

💾 생성된 파일들:
   📁 klue_keyword_extractor_20250618_164856/
   🏆 best_model_20250618_164856.pt
   📊 training_history_20250618_164856.png

💡 GPU 사용을 위한 팁:
   1. NVIDIA GPU 설치 확인
   2. CUDA 드라이버 설치
   3. PyTorch CUDA 버전 재설치:
      pip uninstall torch torchvision torchaudio
      pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
